let cmn={},INIT_PAGE={},PAGES=[],LOADING_PATHS="",BLOG_COUNT_POSTS=0,BUSINESS_QUOTES_ORIGINAL=[],BUSINESS_QUOTES=[],BUSINESS_QUOTES_NUM=0,BLOG_POSTS=[],CATEGORIES=[],CATEGORY={},SEARCH_HIT_COUNT=0,IS_HISTORY_API=(SEARCH_HIT_TEXT="",CATEGORY_HIT_COUNT=0,cmn.saveFormData=t=>{var e=document.querySelector(t);if(e){e=new FormData(e);let a={};e.forEach((t,e)=>{a[e]=t}),sessionStorage.setItem(t,JSON.stringify(a))}},cmn.loadFormData=t=>{let s=document.querySelector(t);if(s){t=sessionStorage.getItem(t);if(t){let a=JSON.parse(t);Object.keys(a).forEach(e=>{var t=s.querySelector(`[name="${e}"]`);t&&("checkbox"===t.type||"radio"===t.type?s.querySelectorAll(`[name="${e}"]`).forEach(t=>{t.checked=t.value===a[e]}):"SELECT"===t.tagName&&Array.isArray(a[e])?Array.from(t.options).forEach(t=>{t.selected=a[e].includes(t.value)}):t.value=a[e])})}}},cmn.getDir=t=>{let e=t.split("/").filter(Boolean),a={};return 0===e.length?a.level1="home":e.forEach((t,e)=>{a["level"+(e+1)]=t}),a},cmn.getNrToBr=(t="")=>t=(t=(t=t.replace(/\r\n/g,"<br>")).replace(/\r/g,"<br>")).replace(/\n/g,"<br>"),cmn.getParam=t=>{let e=t||location.href,a=[],s={},o;for(o in e=1<e.split("?").length?e.split("?")[1]:e,a=e.split("&")){var n=a[o].split("=");2==n.length&&""!=n[1].trim()&&(s[n[0]]=n[1])}return s},history&&history.pushState&&void 0!==history.state),IS_HISTORY_PUSH=!1,historySet=(cmn.historyPushState=(t,e,a)=>{IS_HISTORY_API&&(history.pushState(t,e,a),IS_HISTORY_PUSH=!0)},e=>{IS_HISTORY_API&&$(window).on("popstate",function(t){e&&IS_HISTORY_PUSH&&e(t.originalEvent.state)})}),scroll=($(document).on("mouseenter","a, button",function(){$(this).addClass("hover")}),$(document).on("mouseleave","a, button",function(){$(this).removeClass("hover")}),cmn.loadHtml=async(e,t={})=>{try{var a=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/html"},body:JSON.stringify(t)});if(a.ok)return await a.text();throw new Error("HTTPエラー: "+a.status)}catch(t){return console.error("HTMLの取得に失敗:",t,e),null}},cmn.loadJson=async t=>{try{var e=await fetch(t);if(e.ok)return await e.json();throw new Error("HTTPエラー: "+e.status)}catch(t){return console.error("JSONの取得に失敗:",t),null}},cmn.pageScroll=(t=1,e=300,a)=>($("html, body").stop(),$("html").animate({scrollTop:t},e),$("body").animate({scrollTop:t},e,function(){a&&a()}),!1),{}),IS_LOCALSTORAGE=(scroll.is_touch=!!("ontouchstart"in window&&"ontouchend"in window||navigator.msPointerEnabled||0<navigator.maxTouchPoints),scroll.eventstart=scroll.is_touch?"touchstart":"mousedown",scroll.eventmove=scroll.is_touch?"touchmove":"mousemove",scroll.eventend=scroll.is_touch?"touchend":"mouseup",scroll.isNumber=(t="")=>/^[0-9]+$/.test(t),(()=>{let t=new $.Event("resizestop"),e;$(window).on("resize",()=>{e&&clearTimeout(e),e=setTimeout(function(){$(window).trigger(t)},300)})})(),scroll.show=(a=".scroll",s={})=>{let o=$(a),t=$(".scroll__outer",o),n=$(".scroll__inner",o),i=$(".scroll__content",o),e=$(".scroll__bar",o);if(scroll.is_touch)return t.width("").height(""),!1;if(0===o.length||0===t.length||0===n.length||0===i.length)return!1;let l=s.direction||"horizontal",r="horizontal"===l,c="horizontal"===l?"left":"top",h="horizontal"===l?"width":"height",m="horizontal"===l?"height":"width",g="horizontal"===l?"margin-top":"margin-left",p="";s.bg&&(p+=a+" .scroll__bar::after{background:"+s.bg+"}",delete s.bg),s.color&&(p+=a+" .scroll__bar span::after{background:"+s.color+"}",delete s.color),s.size&&scroll.isNumber(s.size)&&(p+=a+" .scroll__bar span::after{"+m+":"+Math.min(s.size,20)+"px;"+g+": "+Math.min(s.size,20)/2*-1+"px}",delete s.size),s.bg_size&&scroll.isNumber(s.size)&&(p+=a+" .scroll__bar::after{"+m+":"+Math.min(s.bg_size,20)+"px;"+g+": "+Math.min(s.bg_size,20)/2*-1+"px}",delete s.bg_size),""!=p&&$("head").append("<style>"+p+"</style>"),n.css({overflow:"hidden"});var _=i[0].scrollWidth,d=i[0].scrollHeight;let u=r?o.width():o.height(),S=r?_:d;if(!(1<=Math.abs(u-S)&&1<S-u))return 0<e.length&&e.hide(),!1;e.show(),n.css({overflow:"auto"});let b=!1,f=0,w=0,v=0,T,I=0,y=0,E=0,O=!1;u-=s.padding||0;n.on("scroll",()=>{if(b)return!1;var t=r?i.position().left:i.position().top;let e=Math.ceil(Math.abs(t)/S*100);100<e+y&&(e=100-y),N.css(c,e+"%")}),$(window).on("resize",()=>{O=!0}),$(window).on("resizestop",()=>{var t=$(".scroll__bar-control",o),e=r?t.width():t.height();T=r?window.innerWidth:window.innerHeight,v!=T&&(scroll.show(a,s),0<t.length&&(I=u-e),O=!1,v=T)}),0===e.length&&(o.append(`
      <div class="scroll__bar scroll__bar--${l}">
        <span class="scroll__bar-control"></span>
      </div>
    `),e=$(".scroll__bar",o),s.padding)&&e.css(h,"calc(100% - "+s.padding+"px)").css(c,s.padding/2+"px");let N=$(".scroll__bar-control",o);r?(t.height(d),n.height(d+30)):(t.width(_),n.width(_+30)),y=Math.ceil(u/S*100),E=r?(N.width(y+"%"),N.width()):(N.height(y+"%"),N.height()),I||(I=u-E,(()=>{let e;N.on(scroll.eventstart,function(t){b=!0,e=r?i.position().left:i.position().top,f=r?t.pageX:t.pageY,w=Math.floor(Math.abs(e)/S*u)}),$(document).on(scroll.eventmove,function(a){if(b&&!O){a=(r?a.pageX:a.pageY)-f,a=w+a;let t=0,e;a=Math.max(0,a),a=Math.min(Math.ceil(I),a),t=Math.ceil(a/u*100),e=S*(t/100),100<t+y&&(t=100-y),N.css(c,t+"%"),r?n.scrollLeft(e):n.scrollTop(e)}}),$(document).on(scroll.eventend,function(){b=!1})})())},cmn.shuffleArray=(t=[])=>{let e,a;for(e=t.length;1<e;e--)a=Math.floor(Math.random()*e),[t[a],t[e-1]]=[t[e-1],t[a]];return t},"localStorage"in window&&null!==window.localStorage),IS_SESSIONSTORAGE="sessionStorage"in window&&null!==window.sessionStorage,changePage=(cmn.storageLS=(e,t)=>{let a=null;if(IS_LOCALSTORAGE&&void 0!==e)if(void 0!==t)localStorage[e]="object"==typeof t?JSON.stringify(t):t;else try{a=new Function("return "+localStorage[e])()}catch(t){a=localStorage[e]}return a},cmn.storageDelLS=t=>{localStorage.removeItem(t)},cmn.storageSS=(e,t)=>{let a=null;if(IS_SESSIONSTORAGE&&void 0!==e)if(void 0!==t)sessionStorage[e]="object"==typeof t?JSON.stringify(t):t;else try{a=new Function("return "+sessionStorage[e])()}catch(t){a=sessionStorage[e]}return a},cmn.storageDelSS=t=>{sessionStorage.removeItem(t)},$(()=>{let c=!1;$(document).on("click",".js-comment-submit",async function(){let t=$(this),e=t.closest(".js-form-comment"),a=$('[name="comment"]',e),s=$('[name="author"]',e),o=$(".js-comment-notification",e),n=$('[name="comment_post_ID"]',e).val();var i,l,r=new FormData(e[0]),r=Object.fromEntries(r.entries());if(a.on("input",()=>{o.removeClass("caution").hide()}),!c){if(""===a.val().trim())return o.addClass("caution").html("コメントが入力されていることをご確認の上、もう一度お試しください。").show(),!1;c=!0,t.html('<span class="animation-blinker">送信中...</span>'),$(".js-comment-list").attr("data-id",n),"success"===await(await fetch("/assets/ajax/parts/post-comment-form.php",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":CSRF_TOKEN},body:JSON.stringify(r)})).text()?(o.removeClass("caution").html("コメントありがとうございます！").show(),r=cmn.getNrToBr(a.val().trim().replace(/</g,"＜").replace(/>/g,"＞")),i=cmn.getNrToBr(s.val().trim().replace(/</g,"＜").replace(/>/g,"＞")),l=$('.js-comment-list[data-id="'+n+'"]'),r=`
          <li class="comment__unit">
            <p class="comment__unit-text">${r}</p>
            <p class="comment__unit-info">
              <span>${i}</span>
              <time>now</time>
            </p>
          </li>
        `,console.log(l.length),0<l.length&&(0<$("li",l).length?$("li:first-child",l).before(r):l.append(r)),a.val(""),s.val(""),PAGES=PAGES.filter(t=>t.data.id!==n)):o.addClass("caution").html("コメント送信できませんでした。恐れ入りますが、もう一度お試しください。").show(),c=!1,t.html("コメントする")}return!1})}),(s={},t)=>{let o=s.paths||"/",n=$("body"),i=$(".js-contents"),l=(_contents_inner=$(".js-contents-inner"),_contents_blog=$(".js-contents-blog"),_contents_blog_header_inner=$(".js-contents-blog-header-inner"),!1);switch(INIT_PAGE.paths=cmn.getDir(o),INIT_PAGE.paths.level1){case"home":case"blog":case"service":case"about":case"contact":case"privacy":INIT_PAGE.page=INIT_PAGE.paths.level1;break;case"web":case"video":case"overview":l=!0,INIT_PAGE.page="blog";break;default:INIT_PAGE.page="404"}_contents_blog_header_inner.animate({top:-10,opacity:0}),i.animate({top:-10,opacity:0},350,async function(){n.addClass("loading"),$("html, body").scrollTop(1),_contents_blog.hide(),s.title_head="",s.description="",s.image_ogp="";var e=PAGES.find(t=>t.paths===o.replace(/\/$/,""));if(e&&e.data&&e.data.html)s.html=e.data.html;else{if(l){if(s.blog_id||s.blog_category_id||("post"===(e=await cmn.loadJson("/assets/ajax/blog-type.php?paths="+o.replace(/^\/|\/$/g,""))).type?s.blog_id=e.id:s.blog_category_id=e.id),s.blog_id&&0<+s.blog_id)(s=await cmn.loadJson("/assets/ajax/blog-detail.php?blog_id="+s.blog_id)).html=await cmn.loadHtml("/assets/ajax/blog.php",s);else if(s.blog_category_id&&0<+s.blog_category_id){var e=BLOG_POSTS.filter(t=>t.category_ids.some(t=>t==s.blog_category_id));let t="";if(0<e.length){for(var a of e)t+=htmlBlogList(a);s.type="list",s.html_list=t,s.count=e.length,s.topicpath="",s.title_head="",s.description="",s.image_ogp="",s.html=await cmn.loadHtml("/assets/ajax/blog.php",s)}else t="error",s.blog_category_id="",s.description="",s.image_ogp="",s.title_head=""}}else if(s.blog_search)s.paths=o.replace(/^\/|\/$/g,""),s.q=s.blog_search,s.html=await cmn.loadHtml("/assets/ajax/blog.php",s),s.title_head="制作ブログ「"+s.blog_search+"」の検索結果 - シンプルシンプルデザイン",s.description="",s.image_ogp="";else if(s.html=await cmn.loadHtml("/assets/ajax/"+INIT_PAGE.page+".php?paths="+o.replace(/^\/|\/$/g,"")),s.html){switch(INIT_PAGE.page){case"home":s.title_head="Webアプリ制作・映像撮影編集ならシンプルシンプルデザイン",s.description="個人向け、小規模企業、新事業向けのWeb制作や映像撮影、編集をしています。",s.image_ogp="";break;case"blog":s.title_head="制作ブログ",s.description="Web制作や映像制作の備忘録。",s.image_ogp="";break;case"service":if(INIT_PAGE.paths.level2)switch(INIT_PAGE.paths.level2){case"service1":s.title_head="サービス1",s.description="",s.image_ogp="";break;case"service2":s.title_head="サービス2",s.description="",s.image_ogp="";break;case"service3":s.title_head="サービス3",s.description="",s.image_ogp=""}else s.title_head="サービス",s.description="",s.image_ogp="";break;case"about":s.title_head="事業について",s.description="事業理念、事業概要、代表プロフィールを紹介します。",s.image_ogp="";break;case"contact":s.title_head="お問い合わせ",s.description="",s.image_ogp="";break;case"privacy":s.title_head="プライバシーポリシー",s.description="",s.image_ogp="";break;case"web":s.title_head="制作ブログ「Web制作」",s.description="",s.image_ogp="";break;case"video":s.title_head="制作ブログ「映像制作」",s.description="",s.image_ogp="";break;case"overview":s.title_head="制作ブログ「運用情報」",s.description="",s.image_ogp=""}"home"!=INIT_PAGE.page&&(s.title_head=s.title_head+" - シンプルシンプルデザイン")}else s=null;s?PAGES.push({paths:o.replace(/\/$/,""),data:s}):(s.title_head="ページが見つかりませんでした",s.description="ページが見つかりませんでした",s.html="TODO ERROR")}LOADING_PATHS===o&&(t&&cmn.historyPushState({paths:o,data:s},"",o),_contents_inner.html(s.html),_contents_inner.filter("script").each(function(){$.globalEval(this.text)}),"home"===INIT_PAGE.paths.level1&&BUSINESS_QUOTES&&0<BUSINESS_QUOTES.length&&(""!=(e=BUSINESS_QUOTES[BUSINESS_QUOTES_NUM]).word_business&&(e.word_business=`<span>（${e.word_business}）</span>`),$(".js-businessquotes").css({fontSize:getFontSizeOnMainvisual(e.title,1.2),lineHeight:1.2}).html(`
          <p class="businessquotes__word"><span>${e.title}</span></p>
          <p class="businessquotes__name"><span>${e.word_name}${e.word_business}</span></p>
        `),BUSINESS_QUOTES_NUM+=1,BUSINESS_QUOTES.length===BUSINESS_QUOTES_NUM)&&(BUSINESS_QUOTES_NUM=0),"contact"===INIT_PAGE.paths.level1&&cmn.loadFormData(".js-form-contact"),"blog"===INIT_PAGE.page?(_contents_blog.show(),scroll.show(".js-blog-list-1"),scroll.show(".js-blog-list-2"),scroll.show(".js-blog-list-3")):_contents_blog.hide(),n.removeClass("loading"),$("html, body").scrollTop(1),$(".js-menu, .js-modal").removeClass("show").addClass("hide"),_contents_blog_header_inner.animate({top:0,opacity:1},350),i.animate({top:0,opacity:1},350),$("title").text(s.title_head),$('meta[name="description"]').attr("content",s.description),$('link[rel="canonical"]').attr("href","https://simplesimples.com"+o),$("#og-image").attr("content",s.image_ogp))})}),getBusinessquotes=($(()=>{let c=!1,h=t=>{$('.js-form-contact button[type="button"]').before('<p class="contact__error js-contact-error">'+t+"</p>")};$(document).on("click",'.js-form-contact button[type="button"]',async function(){let t=$(this),e=t.closest(".js-form-contact"),s=$(".js-contact-error",e),o=$(".js-contact-success",e),n=$(".js-contact-success-hide",e);if($(".js-link-contact-noreply",e).on("click",()=>(n.toggle(),!1)),!c){s.remove(),o.hide();var i=new FormData(e.get(0));let a={};if(i.forEach((t,e)=>{a[e]=t}),""===a.name.trim())return h("お名前を入力してください。"),!1;if(!/\S+@\S+\.\S+/.test(a.email))return h("メールアドレスを入力してください。"),!1;if(""===a.content.trim())return h("お問い合わせ内容を入力してください。"),!1;c=!0,t.html('<span class="animation-blinker">送信中...</span>');var i=a.email,l=`
<p>【こちらは自動返信メールです】</p>
<p>このたびは、数ある同業社の中から、シンプルシンプルデザインにお問い合わせいただき、誠にありがとうございます。<br>内容を確認させていただいた後、3営業日以内に担当者からご連絡いたします。<br>申し訳ありませんが、営業メールには返信致しかねますので予めご了承くださいませ。</p>
<p>
<strong>お問い合わせ内容</strong><br>
${a.contact.trim()}
</p>
<p>
<strong>会社名</strong><br>
${a.company.trim()}
</p>
<p>
<strong>お名前</strong><br>
${a.name.trim()}
</p>
<p>
<strong>メールアドレス</strong><br>
${a.email}
</p>
<p>
<strong>お問い合わせ内容詳細</strong><br>
${a.content.trim()}
</p>
            `,r=`
【こちらは自動返信メールです】


このたびは、数ある同業社の中から、シンプルシンプルデザインにお問い合わせいただき、誠にありがとうございます。
内容を確認させていただいた後、3営業日以内に担当者からご連絡いたします。
申し訳ありませんが、営業メールには返信致しかねますので予めご了承くださいませ。


お問い合わせ内容

${a.contact.trim()}


会社名

${a.company.trim()}


お名前

${a.name.trim()}


お問い合わせ内容詳細

${a.content.trim()}
            `,i=await(await fetch("/assets/ajax/parts/contact-form.php",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":CSRF_TOKEN},body:JSON.stringify({email:i,subject:"【シンプルシンプルデザイン】お問い合わせありがとうございます",body:l,altbody:r})})).json();if("fail"===i.status)switch(i.message){case"Reload_due_to_invalide_request":h("送信できませんでした。");break;case"Error Message body empty":h("入力不備により、送信できませんでした。")}else n.hide(),o.show(),$('[name="name"]').val("");c=!1,t.html("送信する")}return!1}),$(document).on("change",".js-form-contact input, .js-form-contact textarea, .js-form-contact select",()=>{cmn.saveFormData(".js-form-contact")})}),async()=>{var t=cmn.storageLS("businessquotes"),e=new Date,e=+(""+e.getFullYear()+String(e.getMonth()+1).padStart(2,"0")+String(e.getDate()).padStart(2,"0"));let a=!1,s={};if(id=0,t&&t.date&&(e===t.date?a=!0:id=t.id),a)s=t;else{if(!(s=await cmn.loadJson("/assets/ajax/parts/businessquotes2.php?id="+id)))return"";s.date=e,cmn.storageLS("businessquotes",s)}return""!=s.word_business&&(s.word_business=`(${s.word_business})`),`
<p class="businessquotes__word">${s.title}</p>
<p class="businessquotes__name">${s.word_name}${s.word_business}</p>
  `}),getFontSizeOnMainvisual=(t="",e=1)=>{var a=Math.floor(.5*window.innerWidth),s=Math.floor(.5*window.innerHeight),s=Math.floor(Math.sqrt(s*a/(t.length*e)));return Math.min(s,60)},htmlBlogList=($(()=>{let t=$(".js-header-nav"),e=$("a",t);e.on("mouseenter",()=>{t.addClass("over")}).on("mouseleave",()=>{t.removeClass("over")})}),t=>`
<section class="blog-list-unit">
  <a class="blog-list-unit__link" href="${t.link}" data-id="${t.id}">
    <div class="blog-list-unit__inner">
      <figure class="blog-list-unit__figure">
        <span class="blog-list-unit__bg" style="background-image: url(${t.img});"></span>
      </figure>
      <div class="blog-list-unit__text">
        <h1 class="blog-list-unit__title">${t.title}</h1>
        <p class="blog-list-unit__description">${t.description}</p>
        <p class="blog-list-unit__category-and-date">
          <time class="blog-list-unit__date" datetime="${t.datetime}">${t.date}</time>
          <span class="blog-list-unit__category">${t.category_name}</span>
        </p>
      </div>
    </div>
  </a>
</section>
  `);$(()=>{$(document).on("click","a",function(){var t=$(this),e=t.attr("href"),a=t.attr("data-id")||null,t=t.attr("data-category")||null;if(e&&"function"==typeof changePage&&(e.startsWith("/")||e.startsWith("http://simplesimples")||e.startsWith("https://simplesimples")))return paths=e.startsWith("/")?e:new URL(e).pathname,LOADING_PATHS=paths,changePage({paths:paths,blog_id:a||0,blog_category_id:t||0},!0),!1})}),$(()=>{let t=$(".js-menu");$(".js-menu-link").on("click",()=>((t.hasClass("show")||t.hasClass("hide"))&&$(".js-menu").toggleClass("show").toggleClass("hide"),!1))}),$(document).on("submit",".js-form-blog-search",function(){var t=$('input[name="q"]',this),e=t.val().trim();return html_list="",1<e.trim().length&&(LOADING_PATHS="/blog/?q="+e,changePage({paths:LOADING_PATHS,topickpath:`<strong>「${e}」の検索結果</strong>`,blog_search:e,html_list:html_list},!0),t.val("")),!1}),$(()=>{var t=new URL(location.href),t=t.pathname+t.search;let e=cmn.getParam(location.href);LOADING_PATHS=t,historySet(t=>{LOADING_PATHS=t.paths,changePage(t)}),cmn.storageDelSS(".js-form-contact");(async()=>{var t;(BUSINESS_QUOTES_ORIGINAL=await cmn.loadJson("/assets/ajax/parts/businessquotes.php"))&&(BUSINESS_QUOTES=structuredClone(BUSINESS_QUOTES_ORIGINAL),BUSINESS_QUOTES=cmn.shuffleArray(BUSINESS_QUOTES)),(BLOG_POSTS=await cmn.loadJson("/assets/js/blog-list-all.json"))?((CATEGORIES=await cmn.loadJson("/assets/js/category.json"))||console.error("JSONファイルないよ: データのあるドメイン/api2/?class=category&filename=create にアクセス"),await changePage({paths:LOADING_PATHS,blog_search:e.q||null}),(t=$(".js-menu")).hasClass("show")||t.addClass("hide")):console.error("JSONファイルないよ: データのあるドメイン/api2/?class=blog-list&filename=create にアクセス")})()});